<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Daftar Rumah Sakit Surabaya</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.css" rel="stylesheet" />
  <style>
    body { font-family: sans-serif; background-color: #f9fafb; }
    .hospital-card:hover { transform: translateY(-4px); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
  </style>
</head>
<body class="min-h-screen px-4 py-6 max-w-6xl mx-auto">
  <h1 class="text-2xl font-bold text-center mb-4">Daftar Rumah Sakit di Surabaya</h1>
  <div class="flex items-center gap-2 text-gray-700 mb-4">
    <i class="ri-map-pin-line text-lg text-primary"></i>
    <span id="location-info" class="text-sm">Mendeteksi lokasi…</span>
    <button onclick="detectLocation()" class="text-primary underline text-sm ml-2">Refresh</button>
  </div>
  <div class="relative w-full md:w-1/2 mb-6">
    <input type="text" id="search" placeholder="Cari nama/alamat RS…" class="w-full px-4 py-2 rounded border border-gray-300 pr-10" />
    <button id="clear-search" class="absolute right-2 top-2 text-gray-400 hover:text-red-500 hidden">
      <i class="ri-close-line text-xl"></i>
    </button>
  </div>
  <div id="hospital-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>

  <footer class="text-center text-sm text-gray-400 mt-10">uyhaw©2025</footer>

  <script>
    const hospitals = [
      { name: "RSUD Dr. Soetomo", address: "Jl. Mayjen Prof. Dr. Moestopo No.6-8, Surabaya", phone: "031-5501078", wa: "6281234560001" },
      { name: "RSUD Dr. M. Soewandhie", address: "Jl. Tambak Rejo No.45-47, Surabaya", phone: "031-3717141", wa: "6281234560002" },
      { name: "RSUD Bhakti Dharma Husada", address: "Jl. Kendung No.115-117, Surabaya", phone: "031-7409919", wa: "6281234560003" },
      { name: "RSAL Dr. Ramelan", address: "Jl. Gadung No.1, Surabaya", phone: "031-8430488", wa: "" },
      { name: "RSUD Haji", address: "Jl. Manyar Kertoadi No.6, Surabaya", phone: "031-5925000", wa: "" },
      { name: "RS William Booth", address: "Jl. Jembatan Merah No.7-11, Surabaya", phone: "031-3534053", wa: "" },
      { name: "RS Islam Jemursari", address: "Jl. Jemursari No.51-57, Surabaya", phone: "031-8410298", wa: "" },
      { name: "RS Islam A. Yani", address: "Jl. Jend. A. Yani No. 168, Surabaya", phone: "031-8281234", wa: "6281234560004" },
      { name: "RS Premier Surabaya", address: "Jl. Nginden Intan Barat Blok B, Surabaya", phone: "031-5993211", wa: "6281234560005" },
      { name: "RS RKZ Surabaya", address: "Jl. Diponegoro No.51, Surabaya", phone: "031-5678009", wa: "" },
      { name: "RS Mitra Keluarga Surabaya", address: "Jl. Satelit Indah II No.2, Surabaya", phone: "031-7345333", wa: "" },
      { name: "RS Adi Husada Kapasari", address: "Jl. Kapasari No.99, Surabaya", phone: "031-5312333", wa: "6281234560006" },
      { name: "RS Adi Husada Undaan Wetan", address: "Jl. Undaan Wetan No.40-44, Surabaya", phone: "031-5343012", wa: "6281234560007" },
      { name: "RS Onkologi Surabaya", address: "Jl. Kedung Tarukan No.2, Surabaya", phone: "031-5032437", wa: "" },
      { name: "RS PHC Surabaya", address: "Jl. Prapat Kurung Selatan No.1, Surabaya", phone: "031-3281100", wa: "" },
      { name: "RSIA Putri Surabaya", address: "Jl. Arif Rahman Hakim No.60, Surabaya", phone: "031-5995055", wa: "" },
      { name: "RSIA Lombok Dua Dua", address: "Jl. Lombok No.22, Surabaya", phone: "031-5345108", wa: "" },
      { name: "RSIA Kendangsari", address: "Jl. Kendangsari No.38, Surabaya", phone: "031-8490096", wa: "" },
      { name: "RSIA Graha Medika", address: "Jl. Medokan Asri Barat I No.1, Surabaya", phone: "031-5928880", wa: "" }
    ];

    let userLat = null;
    let userLon = null;

    function detectLocation() {
      const info = document.getElementById('location-info');
      if (!navigator.geolocation) {
        info.textContent = 'Geolokasi tidak didukung';
        return;
      }
      navigator.geolocation.getCurrentPosition(
        pos => {
          userLat = pos.coords.latitude;
          userLon = pos.coords.longitude;
          fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${userLat}&lon=${userLon}&email=test@example.com`)
            .then(res => res.json())
            .then(data => {
              info.textContent = data.display_name || 'Lokasi Anda';
              renderList();
            })
            .catch(() => info.textContent = 'Lokasi Anda');
        },
        () => info.textContent = 'Tidak dapat mendeteksi lokasi',
        { enableHighAccuracy: true }
      );
    }

    function calcDistance(lat1, lon1, lat2, lon2) {
      const R = 6371;
      const dLat = (lat2 - lat1) * Math.PI / 180;
      const dLon = (lon2 - lon1) * Math.PI / 180;
      const a = Math.sin(dLat / 2) ** 2 + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon / 2) ** 2;
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
      return (R * c).toFixed(1);
    }

    function renderList() {
      const q = document.getElementById('search').value.toLowerCase();
      const list = document.getElementById('hospital-list');
      list.innerHTML = '';
      hospitals.filter(h => h.name.toLowerCase().includes(q) || h.address.toLowerCase().includes(q))
        .forEach(h => {
          const distText = (userLat && userLon && h.lat && h.lon) ? `${calcDistance(userLat, userLon, h.lat, h.lon)} km dari lokasi Anda` : '';
          list.innerHTML += `
            <div class="hospital-card bg-white p-4 rounded shadow">
              <h2 class="font-semibold text-lg mb-1">${h.name}</h2>
              <p class="text-sm text-gray-500 mb-1">${h.address}</p>
              ${distText ? `<p class='text-sm text-primary flex items-center gap-1 mb-2'><i class='ri-map-pin-distance-line'></i>${distText}</p>` : ''}
              <div class="flex space-x-2 mt-3">
                ${h.phone ? `<a href="tel:${h.phone}" class="flex-1 bg-green-100 text-green-700 text-center py-2 rounded">Telepon</a>` : ''}
                ${h.wa ? `<a href="https://wa.me/${h.wa}" class="flex-1 bg-green-600 text-white text-center py-2 rounded">WhatsApp</a>` : ''}
              </div>
            </div>`;
        });
    }

    document.getElementById('search').addEventListener('input', () => {
      renderList();
      const clearBtn = document.getElementById('clear-search');
      clearBtn.classList.toggle('hidden', document.getElementById('search').value.length === 0);
    });

    document.getElementById('clear-search').addEventListener('click', () => {
      document.getElementById('search').value = '';
      renderList();
      document.getElementById('clear-search').classList.add('hidden');
    });

    detectLocation();
    renderList();
  </script>
</body>
</html>
